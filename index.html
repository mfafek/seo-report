<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Report Gener√°tor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .tab-active { border-bottom: 3px solid #2563eb; color: #2563eb; }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useCallback, memo } = React;

        const calcChange = (current, prev) => {
            if (!prev || prev === 0) return null;
            return Math.round((current - prev) / prev * 1000) / 10;
        };

        const formatNumber = (num) => num.toLocaleString('cs-CZ');
        const formatCurrency = (num) => num.toLocaleString('cs-CZ') + ' Kƒç';

        const getMonthName = (dateStr) => {
            const months = ['leden', '√∫nor', 'b≈ôezen', 'duben', 'kvƒõten', 'ƒçerven',
                          'ƒçervenec', 'srpen', 'z√°≈ô√≠', '≈ô√≠jen', 'listopad', 'prosinec'];
            try {
                const [year, month] = dateStr.split('-');
                return `${months[parseInt(month) - 1]} ${year}`;
            } catch { return dateStr; }
        };

        const ChangeIndicator = ({ current, prev, inverse = false }) => {
            const change = calcChange(current, prev);
            if (change === null) return <span className="text-gray-400 text-sm">NOV√â</span>;
            const isPositive = inverse ? change < 0 : change > 0;
            return (
                <span className={`text-sm font-semibold ${isPositive ? 'text-green-600' : 'text-red-600'}`}>
                    {isPositive ? '‚ñ≤' : '‚ñº'} {change > 0 ? '+' : ''}{change}%
                </span>
            );
        };

        const InputField = memo(({ label, name, value, onChange, type = 'text', placeholder = '' }) => (
            <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-1">{label}</label>
                <input
                    type={type}
                    name={name}
                    defaultValue={value}
                    onBlur={onChange}
                    placeholder={placeholder}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                />
            </div>
        ));

        const TextAreaField = memo(({ label, name, value, onChange, placeholder = '', rows = 4 }) => (
            <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-1">{label}</label>
                <textarea
                    name={name}
                    defaultValue={value}
                    onBlur={onChange}
                    placeholder={placeholder}
                    rows={rows}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                />
            </div>
        ));

        const ReportPreview = ({ data }) => {
            const topPages = data.topPages.split('\n').filter(l => l.trim()).map(line => {
                const parts = line.split('|').map(p => p.trim());
                return { url: parts[0] || '', conversions: parseInt(parts[1]) || 0, convRate: parseFloat(parts[2]) || 0, revenue: parseInt(parts[3]) || 0 };
            });

            const keywords = data.topKeywords.split('\n').filter(l => l.trim()).map(line => {
                const parts = line.split('|').map(p => p.trim());
                return { keyword: parts[0] || '', intent: parts[1] || 'Informaƒçn√≠', clicks: parseInt(parts[2]) || 0, position: parseFloat(parts[3]) || 0 };
            });

            const priorities = data.priorities.split('\n').filter(l => l.trim()).map(line => {
                const parts = line.split('|').map(p => p.trim());
                return { action: parts[0] || '', impact: parts[1] || '', effort: parts[2] || '', priority: parts[3] || 'ST≈òEDN√ç' };
            });

            const realizedList = data.realized.split('\n').filter(l => l.trim());
            const plannedList = data.planned.split('\n').filter(l => l.trim());
            const roi = data.seoFee > 0 ? Math.round((data.revenue - data.seoFee) / data.seoFee * 100) : 0;

            return (
                <div className="bg-white max-w-4xl mx-auto p-8 shadow-lg" id="report">
                    <div className="flex justify-between items-center pb-4 border-b-4 border-blue-700 mb-6">
                        <div>
                            <div className="text-2xl font-bold text-blue-700">{data.clientLogo} {(data.clientName || 'KLIENT').split('.')[0].toUpperCase()}</div>
                            <div className="text-sm text-gray-500">Mƒõs√≠ƒçn√≠ SEO Report</div>
                        </div>
                        <div className="text-right">
                            <div className="text-xl font-bold">{getMonthName(data.reportMonth)}</div>
                            <div className="text-sm text-gray-500">vs. p≈ôedchoz√≠ rok</div>
                        </div>
                    </div>

                    <h2 className="text-lg font-bold text-blue-700 mb-4 pb-2 border-b-2 border-gray-200">üìä Shrnut√≠</h2>
                    <div className="grid grid-cols-4 gap-4 mb-6">
                        <div className={`bg-gray-50 rounded-lg p-4 border-l-4 ${calcChange(data.revenue, data.revenuePrev) < 0 ? 'border-red-500' : 'border-green-500'}`}>
                            <div className="text-xs text-gray-500 uppercase mb-1">Tr≈æby z organiku</div>
                            <div className="text-2xl font-bold">{formatCurrency(data.revenue)}</div>
                            <ChangeIndicator current={data.revenue} prev={data.revenuePrev} />
                        </div>
                        <div className={`bg-gray-50 rounded-lg p-4 border-l-4 ${calcChange(data.conversions, data.conversionsPrev) < 0 ? 'border-red-500' : 'border-green-500'}`}>
                            <div className="text-xs text-gray-500 uppercase mb-1">Konverze</div>
                            <div className="text-2xl font-bold">{data.conversions}</div>
                            <ChangeIndicator current={data.conversions} prev={data.conversionsPrev} />
                        </div>
                        <div className={`bg-gray-50 rounded-lg p-4 border-l-4 ${calcChange(data.convRate, data.convRatePrev) < 0 ? 'border-red-500' : 'border-green-500'}`}>
                            <div className="text-xs text-gray-500 uppercase mb-1">M√≠ra konverze</div>
                            <div className="text-2xl font-bold">{data.convRate}%</div>
                            <ChangeIndicator current={data.convRate} prev={data.convRatePrev} />
                        </div>
                        <div className="bg-gray-50 rounded-lg p-4 border-l-4 border-blue-500">
                            <div className="text-xs text-gray-500 uppercase mb-1">ROI SEO</div>
                            <div className="text-2xl font-bold">{roi}%</div>
                            <div className="text-sm text-gray-500">Cena: {formatCurrency(data.seoFee)}</div>
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-6 mb-6">
                        <div className="bg-gray-50 rounded-lg p-4">
                            <div className="font-semibold text-gray-700 mb-3">üèÜ Top str√°nky dle konverz√≠</div>
                            <table className="w-full text-sm">
                                <thead><tr className="bg-blue-700 text-white"><th className="p-2 text-left rounded-tl-lg">Str√°nka</th><th className="p-2 text-right">Konv.</th><th className="p-2 text-right rounded-tr-lg">M√≠ra</th></tr></thead>
                                <tbody>
                                    {topPages.slice(0, 5).map((page, i) => (
                                        <tr key={i} className="border-b border-gray-200">
                                            <td className="p-2">{page.url.slice(0, 20)}</td>
                                            <td className="p-2 text-right font-semibold">{page.conversions}</td>
                                            <td className={`p-2 text-right ${page.convRate > 5 ? 'text-green-600 font-semibold' : ''}`}>{page.convRate}%</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>

                        <div className="bg-gray-50 rounded-lg p-4">
                            <div className="font-semibold text-gray-700 mb-3">üìà P≈ôehled n√°v≈°tƒõvnosti</div>
                            <div className="space-y-2">
                                <div className="flex justify-between py-2 border-b border-gray-200"><span className="text-gray-600">N√°v≈°tƒõvy</span><span className="font-semibold">{formatNumber(data.sessions)} <ChangeIndicator current={data.sessions} prev={data.sessionsPrev} /></span></div>
                                <div className="flex justify-between py-2 border-b border-gray-200"><span className="text-gray-600">Prokliky</span><span className="font-semibold">{formatNumber(data.clicks)} <ChangeIndicator current={data.clicks} prev={data.clicksPrev} /></span></div>
                                <div className="flex justify-between py-2 border-b border-gray-200"><span className="text-gray-600">Zobrazen√≠</span><span className="font-semibold">{formatNumber(data.impressions)} <ChangeIndicator current={data.impressions} prev={data.impressionsPrev} /></span></div>
                                <div className="flex justify-between py-2 border-b border-gray-200"><span className="text-gray-600">Pr≈Øm. pozice</span><span className="font-semibold">{data.avgPosition.toFixed(2)} <ChangeIndicator current={data.avgPosition} prev={data.avgPositionPrev} inverse={true} /></span></div>
                                <div className="flex justify-between py-2"><span className="text-gray-600">CTR</span><span className="font-semibold">{data.ctr}% <ChangeIndicator current={data.ctr} prev={data.ctrPrev} /></span></div>
                            </div>
                        </div>
                    </div>

                    {data.summary && (
                        <div className="bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg p-4 mb-6">
                            <div className="font-semibold text-yellow-800 mb-2">üí¨ Koment√°≈ô mƒõs√≠ce</div>
                            <div className="text-yellow-900">{data.summary}</div>
                        </div>
                    )}

                    {keywords.length > 0 && (
                        <>
                            <h2 className="text-lg font-bold text-blue-700 mb-4 pb-2 border-b-2 border-gray-200">üéØ Top kl√≠ƒçov√° slova</h2>
                            <div className="bg-gray-50 rounded-lg p-4 mb-6">
                                <table className="w-full text-sm">
                                    <thead><tr className="bg-blue-700 text-white"><th className="p-2 text-left rounded-tl-lg">Kl√≠ƒçov√© slovo</th><th className="p-2">Z√°mƒõr</th><th className="p-2 text-right">Prokliky</th><th className="p-2 text-right rounded-tr-lg">Pozice</th></tr></thead>
                                    <tbody>
                                        {keywords.slice(0, 10).map((kw, i) => (
                                            <tr key={i} className="border-b border-gray-200">
                                                <td className="p-2 font-semibold">{kw.keyword}</td>
                                                <td className="p-2 text-center"><span className={`px-2 py-1 rounded text-xs font-semibold ${kw.intent === 'Transakƒçn√≠' ? 'bg-green-100 text-green-800' : kw.intent === 'Komerƒçn√≠' ? 'bg-yellow-100 text-yellow-800' : kw.intent === 'Informaƒçn√≠' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800'}`}>{kw.intent}</span></td>
                                                <td className="p-2 text-right">{kw.clicks}</td>
                                                <td className={`p-2 text-right ${kw.position <= 3 ? 'text-green-600 font-semibold' : kw.position > 10 ? 'text-red-600' : ''}`}>{kw.position.toFixed(2)}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </>
                    )}

                    {(realizedList.length > 0 || plannedList.length > 0) && (
                        <>
                            <h2 className="text-lg font-bold text-blue-700 mb-4 pb-2 border-b-2 border-gray-200">üöÄ Aktivity</h2>
                            <div className="grid grid-cols-2 gap-6 mb-6">
                                {realizedList.length > 0 && (
                                    <div className="bg-green-50 rounded-lg p-4">
                                        <h4 className="font-semibold text-green-700 mb-3">‚úÖ Realizov√°no</h4>
                                        <ul className="space-y-1">{realizedList.map((item, i) => <li key={i} className="text-sm">‚úì {item}</li>)}</ul>
                                    </div>
                                )}
                                {plannedList.length > 0 && (
                                    <div className="bg-blue-50 rounded-lg p-4">
                                        <h4 className="font-semibold text-blue-700 mb-3">‚öôÔ∏è Pl√°nov√°no</h4>
                                        <ul className="space-y-1">{plannedList.map((item, i) => <li key={i} className="text-sm">‚óã {item}</li>)}</ul>
                                    </div>
                                )}
                            </div>
                        </>
                    )}

                    {priorities.length > 0 && (
                        <div className="bg-gray-50 rounded-lg p-4 mb-6">
                            <div className="font-semibold text-gray-700 mb-3">üéØ Priority</div>
                            <table className="w-full text-sm">
                                <thead><tr className="bg-blue-700 text-white"><th className="p-2 text-left rounded-tl-lg">Akce</th><th className="p-2 text-center">Dopad</th><th className="p-2 text-center">N√°roƒçnost</th><th className="p-2 text-center rounded-tr-lg">Priorita</th></tr></thead>
                                <tbody>
                                    {priorities.map((p, i) => (
                                        <tr key={i} className={`border-b border-gray-200 ${p.priority === 'VYSOK√Å' ? 'bg-yellow-50' : ''}`}>
                                            <td className="p-2 font-semibold">{p.action}</td>
                                            <td className="p-2 text-center text-green-600">{p.impact}</td>
                                            <td className="p-2 text-center">{p.effort}</td>
                                            <td className="p-2 text-center"><span className={`px-2 py-1 rounded text-xs font-semibold ${p.priority === 'VYSOK√Å' ? 'bg-red-100 text-red-800' : p.priority === 'ST≈òEDN√ç' ? 'bg-yellow-100 text-yellow-800' : 'bg-green-100 text-green-800'}`}>{p.priority === 'VYSOK√Å' ? 'üî¥' : p.priority === 'ST≈òEDN√ç' ? 'üü°' : 'üü¢'} {p.priority}</span></td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    )}

                    <div className="mt-8 pt-4 border-t-2 border-gray-200 text-center">
                        <div className="text-sm text-gray-500">P≈ôipravil</div>
                        <div className="text-lg font-bold text-blue-700">{data.preparedBy}</div>
                    </div>
                </div>
            );
        };

        function App() {
            const [activeTab, setActiveTab] = useState(0);
            const [showPreview, setShowPreview] = useState(false);
            const [data, setData] = useState({
                clientName: '', clientLogo: 'üåø', reportMonth: new Date().toISOString().slice(0, 7), preparedBy: '', seoFee: 15000,
                revenue: 0, revenuePrev: 0, conversions: 0, conversionsPrev: 0, convRate: 0, convRatePrev: 0,
                sessions: 0, sessionsPrev: 0, clicks: 0, clicksPrev: 0, impressions: 0, impressionsPrev: 0,
                avgPosition: 0, avgPositionPrev: 0, ctr: 0, ctrPrev: 0,
                topPages: '', topKeywords: '', summary: '', realized: '', planned: '', priorities: ''
            });

            const handleBlur = useCallback((e) => {
                const { name, value, type } = e.target;
                setData(prev => ({ ...prev, [name]: type === 'number' ? parseFloat(value) || 0 : value }));
            }, []);

            const tabs = ['1Ô∏è‚É£ Info', '2Ô∏è‚É£ Byznys', '3Ô∏è‚É£ N√°v≈°tƒõvnost', '4Ô∏è‚É£ Data', '5Ô∏è‚É£ Text'];

            return (
                <div className="min-h-screen bg-gray-100">
                    <div className="bg-white shadow-sm no-print">
                        <div className="max-w-6xl mx-auto px-4 py-4">
                            <h1 className="text-2xl font-bold text-gray-800">üìä SEO Report Gener√°tor</h1>
                            <p className="text-gray-500">N√°stroj pro tvorbu SEO report≈Ø zamƒõ≈ôen√Ωch na konverze</p>
                        </div>
                    </div>

                    {!showPreview ? (
                        <div className="max-w-4xl mx-auto px-4 py-6 no-print">
                            <div className="flex border-b border-gray-200 mb-6">
                                {tabs.map((tab, i) => (
                                    <button key={i} onClick={() => setActiveTab(i)} className={`px-4 py-2 font-medium ${activeTab === i ? 'tab-active' : 'text-gray-500 hover:text-gray-700'}`}>{tab}</button>
                                ))}
                            </div>

                            <div className="bg-white rounded-lg shadow p-6">
                                {activeTab === 0 && (
                                    <div className="grid grid-cols-2 gap-4">
                                        <InputField label="Web / Klient" name="clientName" value={data.clientName} onChange={handleBlur} placeholder="example.cz" />
                                        <InputField label="Logo (emoji)" name="clientLogo" value={data.clientLogo} onChange={handleBlur} />
                                        <InputField label="Mƒõs√≠c (RRRR-MM)" name="reportMonth" value={data.reportMonth} onChange={handleBlur} />
                                        <InputField label="P≈ôipravil" name="preparedBy" value={data.preparedBy} onChange={handleBlur} />
                                        <InputField label="Cena SEO (Kƒç)" name="seoFee" value={data.seoFee} onChange={handleBlur} type="number" />
                                    </div>
                                )}

                                {activeTab === 1 && (
                                    <div>
                                        <p className="text-sm text-gray-500 mb-4">üí° GA4 ‚Üí P≈ôehledy ‚Üí Akvizice ‚Üí Zdroje n√°v≈°tƒõvnosti ‚Üí Filtr: Organic Search</p>
                                        <div className="grid grid-cols-2 gap-4">
                                            <InputField label="Tr≈æby (Kƒç)" name="revenue" value={data.revenue} onChange={handleBlur} type="number" />
                                            <InputField label="Tr≈æby YoY" name="revenuePrev" value={data.revenuePrev} onChange={handleBlur} type="number" />
                                            <InputField label="Konverze" name="conversions" value={data.conversions} onChange={handleBlur} type="number" />
                                            <InputField label="Konverze YoY" name="conversionsPrev" value={data.conversionsPrev} onChange={handleBlur} type="number" />
                                            <InputField label="M√≠ra konverze (%)" name="convRate" value={data.convRate} onChange={handleBlur} type="number" />
                                            <InputField label="M√≠ra konverze YoY" name="convRatePrev" value={data.convRatePrev} onChange={handleBlur} type="number" />
                                        </div>
                                    </div>
                                )}

                                {activeTab === 2 && (
                                    <div className="grid grid-cols-2 gap-4">
                                        <InputField label="N√°v≈°tƒõvy" name="sessions" value={data.sessions} onChange={handleBlur} type="number" />
                                        <InputField label="N√°v≈°tƒõvy YoY" name="sessionsPrev" value={data.sessionsPrev} onChange={handleBlur} type="number" />
                                        <InputField label="Prokliky" name="clicks" value={data.clicks} onChange={handleBlur} type="number" />
                                        <InputField label="Prokliky YoY" name="clicksPrev" value={data.clicksPrev} onChange={handleBlur} type="number" />
                                        <InputField label="Zobrazen√≠" name="impressions" value={data.impressions} onChange={handleBlur} type="number" />
                                        <InputField label="Zobrazen√≠ YoY" name="impressionsPrev" value={data.impressionsPrev} onChange={handleBlur} type="number" />
                                        <InputField label="Pr≈Øm. pozice" name="avgPosition" value={data.avgPosition} onChange={handleBlur} type="number" />
                                        <InputField label="Pozice YoY" name="avgPositionPrev" value={data.avgPositionPrev} onChange={handleBlur} type="number" />
                                        <InputField label="CTR (%)" name="ctr" value={data.ctr} onChange={handleBlur} type="number" />
                                        <InputField label="CTR YoY" name="ctrPrev" value={data.ctrPrev} onChange={handleBlur} type="number" />
                                    </div>
                                )}

                                {activeTab === 3 && (
                                    <div>
                                        <TextAreaField label="Top str√°nky (URL | Konverze | M√≠ra | Tr≈æby)" name="topPages" value={data.topPages} onChange={handleBlur} placeholder="skimmia-japonica | 12 | 7.3 | 15600" rows={5} />
                                        <p className="text-xs text-gray-500 mb-4">Z√°mƒõr: Transakƒçn√≠, Komerƒçn√≠, Informaƒçn√≠, Znaƒçka</p>
                                        <TextAreaField label="Top kl√≠ƒçov√° slova (Slovo | Z√°mƒõr | Prokliky | Pozice)" name="topKeywords" value={data.topKeywords} onChange={handleBlur} placeholder="skimie japonsk√° | Komerƒçn√≠ | 63 | 1.38" rows={5} />
                                    </div>
                                )}

                                {activeTab === 4 && (
                                    <div>
                                        <TextAreaField label="Shrnut√≠ mƒõs√≠ce" name="summary" value={data.summary} onChange={handleBlur} rows={3} />
                                        <div className="grid grid-cols-2 gap-4">
                                            <TextAreaField label="Realizovan√© aktivity" name="realized" value={data.realized} onChange={handleBlur} placeholder="SEO audit" rows={4} />
                                            <TextAreaField label="Pl√°novan√© aktivity" name="planned" value={data.planned} onChange={handleBlur} placeholder="Linkbuilding" rows={4} />
                                        </div>
                                        <TextAreaField label="Priority (Akce | Dopad | N√°roƒçnost | Priorita)" name="priorities" value={data.priorities} onChange={handleBlur} placeholder="Optimalizace | +15% | St≈ôedn√≠ | VYSOK√Å" rows={3} />
                                    </div>
                                )}
                            </div>

                            <div className="flex gap-4 mt-6">
                                <button onClick={() => setShowPreview(true)} className="flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition">üöÄ Zobrazit report</button>
                            </div>
                        </div>
                    ) : (
                        <div>
                            <div className="bg-white shadow-sm py-3 px-4 flex gap-4 justify-center no-print">
                                <button onClick={() => setShowPreview(false)} className="bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 transition">‚Üê Zpƒõt na editaci</button>
                                <button onClick={() => window.print()} className="bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition">üñ®Ô∏è Tisk / PDF</button>
                            </div>
                            <div className="py-6"><ReportPreview data={data} /></div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
