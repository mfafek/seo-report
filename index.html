<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Report Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .tab-active { border-bottom: 3px solid #2563eb; color: #2563eb; }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Pomocn√© funkce
        const calcChange = (current, prev) => {
            if (!prev || prev === 0) return null;
            return Math.round((current - prev) / prev * 1000) / 10;
        };

        const formatNumber = (num) => num.toLocaleString('cs-CZ');
        const formatCurrency = (num) => num.toLocaleString('cs-CZ') + ' Kƒç';

        const getMonthName = (dateStr) => {
            const months = ['leden', '√∫nor', 'b≈ôezen', 'duben', 'kvƒõten', 'ƒçerven',
                          'ƒçervenec', 'srpen', 'z√°≈ô√≠', '≈ô√≠jen', 'listopad', 'prosinec'];
            try {
                const [year, month] = dateStr.split('-');
                return `${months[parseInt(month) - 1]} ${year}`;
            } catch { return dateStr; }
        };

        const ChangeIndicator = ({ current, prev, inverse = false }) => {
            const change = calcChange(current, prev);
            if (change === null) return <span className="text-gray-400 text-sm">NEW</span>;
            const isPositive = inverse ? change < 0 : change > 0;
            return (
                <span className={`text-sm font-semibold ${isPositive ? 'text-green-600' : 'text-red-600'}`}>
                    {isPositive ? '‚ñ≤' : '‚ñº'} {change > 0 ? '+' : ''}{change}%
                </span>
            );
        };

        // Hlavn√≠ aplikace
        function App() {
            const [activeTab, setActiveTab] = useState(0);
            const [showPreview, setShowPreview] = useState(false);
            
            const [data, setData] = useState({
                clientName: '',
                clientLogo: 'üåø',
                reportMonth: new Date().toISOString().slice(0, 7),
                preparedBy: '',
                seoFee: 15000,
                revenue: 0, revenuePrev: 0,
                conversions: 0, conversionsPrev: 0,
                convRate: 0, convRatePrev: 0,
                sessions: 0, sessionsPrev: 0,
                clicks: 0, clicksPrev: 0,
                impressions: 0, impressionsPrev: 0,
                avgPosition: 0, avgPositionPrev: 0,
                ctr: 0, ctrPrev: 0,
                topPages: '',
                topKeywords: '',
                summary: '',
                realized: '',
                planned: '',
                priorities: ''
            });

            const updateData = (field, value) => {
                setData(prev => ({ ...prev, [field]: value }));
            };

            const parseTopPages = () => {
                return data.topPages.split('\n').filter(l => l.trim()).map(line => {
                    const parts = line.split('|').map(p => p.trim());
                    return {
                        url: parts[0] || '',
                        conversions: parseInt(parts[1]) || 0,
                        convRate: parseFloat(parts[2]) || 0,
                        revenue: parseInt(parts[3]) || 0
                    };
                });
            };

            const parseKeywords = () => {
                return data.topKeywords.split('\n').filter(l => l.trim()).map(line => {
                    const parts = line.split('|').map(p => p.trim());
                    return {
                        keyword: parts[0] || '',
                        intent: parts[1] || 'Informational',
                        clicks: parseInt(parts[2]) || 0,
                        position: parseFloat(parts[3]) || 0
                    };
                });
            };

            const parsePriorities = () => {
                return data.priorities.split('\n').filter(l => l.trim()).map(line => {
                    const parts = line.split('|').map(p => p.trim());
                    return {
                        action: parts[0] || '',
                        impact: parts[1] || '',
                        effort: parts[2] || '',
                        priority: parts[3] || 'MEDIUM'
                    };
                });
            };

            const roi = data.seoFee > 0 ? Math.round((data.revenue - data.seoFee) / data.seoFee * 100) : 0;

            const tabs = ['1Ô∏è‚É£ Info', '2Ô∏è‚É£ Byznys', '3Ô∏è‚É£ Traffic', '4Ô∏è‚É£ Data', '5Ô∏è‚É£ Text'];

            const InputField = ({ label, field, type = 'text', placeholder = '' }) => (
                <div className="mb-4">
                    <label className="block text-sm font-medium text-gray-700 mb-1">{label}</label>
                    <input
                        type={type}
                        value={data[field]}
                        onChange={(e) => updateData(field, type === 'number' ? parseFloat(e.target.value) || 0 : e.target.value)}
                        placeholder={placeholder}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    />
                </div>
            );

            const TextArea = ({ label, field, placeholder = '', rows = 4 }) => (
                <div className="mb-4">
                    <label className="block text-sm font-medium text-gray-700 mb-1">{label}</label>
                    <textarea
                        value={data[field]}
                        onChange={(e) => updateData(field, e.target.value)}
                        placeholder={placeholder}
                        rows={rows}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    />
                </div>
            );

            // Report Preview Component
            const ReportPreview = () => {
                const topPages = parseTopPages();
                const keywords = parseKeywords();
                const priorities = parsePriorities();
                const realizedList = data.realized.split('\n').filter(l => l.trim());
                const plannedList = data.planned.split('\n').filter(l => l.trim());

                return (
                    <div className="bg-white max-w-4xl mx-auto p-8 shadow-lg" id="report">
                        {/* Header */}
                        <div className="flex justify-between items-center pb-4 border-b-4 border-blue-700 mb-6">
                            <div>
                                <div className="text-2xl font-bold text-blue-700">
                                    {data.clientLogo} {(data.clientName || 'CLIENT').split('.')[0].toUpperCase()}
                                </div>
                                <div className="text-sm text-gray-500">Mƒõs√≠ƒçn√≠ SEO Report</div>
                            </div>
                            <div className="text-right">
                                <div className="text-xl font-bold">{getMonthName(data.reportMonth)}</div>
                                <div className="text-sm text-gray-500">vs. p≈ôedchoz√≠ rok</div>
                            </div>
                        </div>

                        {/* KPIs */}
                        <h2 className="text-lg font-bold text-blue-700 mb-4 pb-2 border-b-2 border-gray-200">üìä Executive Summary</h2>
                        <div className="grid grid-cols-4 gap-4 mb-6">
                            <div className={`bg-gray-50 rounded-lg p-4 border-l-4 ${calcChange(data.revenue, data.revenuePrev) < 0 ? 'border-red-500' : 'border-green-500'}`}>
                                <div className="text-xs text-gray-500 uppercase mb-1">Revenue z organiku</div>
                                <div className="text-2xl font-bold">{formatCurrency(data.revenue)}</div>
                                <ChangeIndicator current={data.revenue} prev={data.revenuePrev} />
                            </div>
                            <div className={`bg-gray-50 rounded-lg p-4 border-l-4 ${calcChange(data.conversions, data.conversionsPrev) < 0 ? 'border-red-500' : 'border-green-500'}`}>
                                <div className="text-xs text-gray-500 uppercase mb-1">Konverze</div>
                                <div className="text-2xl font-bold">{data.conversions}</div>
                                <ChangeIndicator current={data.conversions} prev={data.conversionsPrev} />
                            </div>
                            <div className={`bg-gray-50 rounded-lg p-4 border-l-4 ${calcChange(data.convRate, data.convRatePrev) < 0 ? 'border-red-500' : 'border-green-500'}`}>
                                <div className="text-xs text-gray-500 uppercase mb-1">Conversion Rate</div>
                                <div className="text-2xl font-bold">{data.convRate}%</div>
                                <ChangeIndicator current={data.convRate} prev={data.convRatePrev} />
                            </div>
                            <div className="bg-gray-50 rounded-lg p-4 border-l-4 border-blue-500">
                                <div className="text-xs text-gray-500 uppercase mb-1">ROI SEO</div>
                                <div className="text-2xl font-bold">{roi}%</div>
                                <div className="text-sm text-gray-500">Fee: {formatCurrency(data.seoFee)}</div>
                            </div>
                        </div>

                        {/* Two columns */}
                        <div className="grid grid-cols-2 gap-6 mb-6">
                            {/* Top Pages */}
                            <div className="bg-gray-50 rounded-lg p-4">
                                <div className="font-semibold text-gray-700 mb-3">üèÜ Top str√°nky podle konverz√≠</div>
                                <table className="w-full text-sm">
                                    <thead>
                                        <tr className="bg-blue-700 text-white">
                                            <th className="p-2 text-left rounded-tl-lg">Str√°nka</th>
                                            <th className="p-2 text-right">Conv.</th>
                                            <th className="p-2 text-right rounded-tr-lg">Rate</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {topPages.slice(0, 5).map((page, i) => (
                                            <tr key={i} className="border-b border-gray-200">
                                                <td className="p-2">{page.url.slice(0, 20)}</td>
                                                <td className="p-2 text-right font-semibold">{page.conversions}</td>
                                                <td className={`p-2 text-right ${page.convRate > 5 ? 'text-green-600 font-semibold' : ''}`}>{page.convRate}%</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>

                            {/* Traffic Scorecard */}
                            <div className="bg-gray-50 rounded-lg p-4">
                                <div className="font-semibold text-gray-700 mb-3">üìà Traffic Scorecard</div>
                                <div className="space-y-2">
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-600">Sessions</span>
                                        <span className="font-semibold">{formatNumber(data.sessions)} <ChangeIndicator current={data.sessions} prev={data.sessionsPrev} /></span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-600">Clicks</span>
                                        <span className="font-semibold">{formatNumber(data.clicks)} <ChangeIndicator current={data.clicks} prev={data.clicksPrev} /></span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-600">Impressions</span>
                                        <span className="font-semibold">{formatNumber(data.impressions)} <ChangeIndicator current={data.impressions} prev={data.impressionsPrev} /></span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-600">Avg. Position</span>
                                        <span className="font-semibold">{data.avgPosition.toFixed(2)} <ChangeIndicator current={data.avgPosition} prev={data.avgPositionPrev} inverse={true} /></span>
                                    </div>
                                    <div className="flex justify-between py-2">
                                        <span className="text-gray-600">CTR</span>
                                        <span className="font-semibold">{data.ctr}% <ChangeIndicator current={data.ctr} prev={data.ctrPrev} /></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Summary */}
                        {data.summary && (
                            <div className="bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg p-4 mb-6">
                                <div className="font-semibold text-yellow-800 mb-2">üí¨ Koment√°≈ô mƒõs√≠ce</div>
                                <div className="text-yellow-900">{data.summary}</div>
                            </div>
                        )}

                        {/* Keywords */}
                        {keywords.length > 0 && (
                            <>
                                <h2 className="text-lg font-bold text-blue-700 mb-4 pb-2 border-b-2 border-gray-200">üéØ Top Keywords</h2>
                                <div className="bg-gray-50 rounded-lg p-4 mb-6">
                                    <table className="w-full text-sm">
                                        <thead>
                                            <tr className="bg-blue-700 text-white">
                                                <th className="p-2 text-left rounded-tl-lg">Keyword</th>
                                                <th className="p-2">Intent</th>
                                                <th className="p-2 text-right">Clicks</th>
                                                <th className="p-2 text-right rounded-tr-lg">Pozice</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {keywords.slice(0, 10).map((kw, i) => (
                                                <tr key={i} className="border-b border-gray-200">
                                                    <td className="p-2 font-semibold">{kw.keyword}</td>
                                                    <td className="p-2 text-center">
                                                        <span className={`px-2 py-1 rounded text-xs font-semibold
                                                            ${kw.intent === 'Transactional' ? 'bg-green-100 text-green-800' : ''}
                                                            ${kw.intent === 'Commercial' ? 'bg-yellow-100 text-yellow-800' : ''}
                                                            ${kw.intent === 'Informational' ? 'bg-blue-100 text-blue-800' : ''}
                                                            ${kw.intent === 'Brand' ? 'bg-purple-100 text-purple-800' : ''}
                                                        `}>{kw.intent}</span>
                                                    </td>
                                                    <td className="p-2 text-right">{kw.clicks}</td>
                                                    <td className={`p-2 text-right ${kw.position <= 3 ? 'text-green-600 font-semibold' : kw.position > 10 ? 'text-red-600' : ''}`}>
                                                        {kw.position.toFixed(2)}
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </>
                        )}

                        {/* Activities */}
                        {(realizedList.length > 0 || plannedList.length > 0) && (
                            <>
                                <h2 className="text-lg font-bold text-blue-700 mb-4 pb-2 border-b-2 border-gray-200">üöÄ Aktivity</h2>
                                <div className="grid grid-cols-2 gap-6 mb-6">
                                    {realizedList.length > 0 && (
                                        <div className="bg-green-50 rounded-lg p-4">
                                            <h4 className="font-semibold text-green-700 mb-3">‚úÖ Realizov√°no</h4>
                                            <ul className="space-y-1">
                                                {realizedList.map((item, i) => (
                                                    <li key={i} className="text-sm">‚úì {item}</li>
                                                ))}
                                            </ul>
                                        </div>
                                    )}
                                    {plannedList.length > 0 && (
                                        <div className="bg-blue-50 rounded-lg p-4">
                                            <h4 className="font-semibold text-blue-700 mb-3">‚öôÔ∏è Pl√°nov√°no</h4>
                                            <ul className="space-y-1">
                                                {plannedList.map((item, i) => (
                                                    <li key={i} className="text-sm">‚óã {item}</li>
                                                ))}
                                            </ul>
                                        </div>
                                    )}
                                </div>
                            </>
                        )}

                        {/* Priorities */}
                        {priorities.length > 0 && (
                            <div className="bg-gray-50 rounded-lg p-4 mb-6">
                                <div className="font-semibold text-gray-700 mb-3">üéØ Priority</div>
                                <table className="w-full text-sm">
                                    <thead>
                                        <tr className="bg-blue-700 text-white">
                                            <th className="p-2 text-left rounded-tl-lg">Akce</th>
                                            <th className="p-2 text-center">Impact</th>
                                            <th className="p-2 text-center">Effort</th>
                                            <th className="p-2 text-center rounded-tr-lg">Priority</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {priorities.map((p, i) => (
                                            <tr key={i} className={`border-b border-gray-200 ${p.priority === 'HIGH' ? 'bg-yellow-50' : ''}`}>
                                                <td className="p-2 font-semibold">{p.action}</td>
                                                <td className="p-2 text-center text-green-600">{p.impact}</td>
                                                <td className="p-2 text-center">{p.effort}</td>
                                                <td className="p-2 text-center">
                                                    <span className={`px-2 py-1 rounded text-xs font-semibold
                                                        ${p.priority === 'HIGH' ? 'bg-red-100 text-red-800' : ''}
                                                        ${p.priority === 'MEDIUM' ? 'bg-yellow-100 text-yellow-800' : ''}
                                                        ${p.priority === 'LOW' ? 'bg-green-100 text-green-800' : ''}
                                                    `}>
                                                        {p.priority === 'HIGH' ? 'üî¥' : p.priority === 'MEDIUM' ? 'üü°' : 'üü¢'} {p.priority}
                                                    </span>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}

                        {/* Footer */}
                        <div className="mt-8 pt-4 border-t-2 border-gray-200 text-center">
                            <div className="text-sm text-gray-500">P≈ôipravil</div>
                            <div className="text-lg font-bold text-blue-700">{data.preparedBy}</div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-gray-100">
                    {/* Header */}
                    <div className="bg-white shadow-sm no-print">
                        <div className="max-w-6xl mx-auto px-4 py-4">
                            <h1 className="text-2xl font-bold text-gray-800">üìä SEO Report Generator</h1>
                            <p className="text-gray-500">Conversion-focused SEO Reporting Tool</p>
                        </div>
                    </div>

                    {!showPreview ? (
                        <div className="max-w-4xl mx-auto px-4 py-6 no-print">
                            {/* Tabs */}
                            <div className="flex border-b border-gray-200 mb-6">
                                {tabs.map((tab, i) => (
                                    <button
                                        key={i}
                                        onClick={() => setActiveTab(i)}
                                        className={`px-4 py-2 font-medium ${activeTab === i ? 'tab-active' : 'text-gray-500 hover:text-gray-700'}`}
                                    >
                                        {tab}
                                    </button>
                                ))}
                            </div>

                            {/* Tab Content */}
                            <div className="bg-white rounded-lg shadow p-6">
                                {activeTab === 0 && (
                                    <div className="grid grid-cols-2 gap-4">
                                        <InputField label="Web / Klient" field="clientName" placeholder="example.cz" />
                                        <InputField label="Logo (emoji)" field="clientLogo" />
                                        <InputField label="Mƒõs√≠c (YYYY-MM)" field="reportMonth" />
                                        <InputField label="P≈ôipravil" field="preparedBy" />
                                        <InputField label="SEO fee (Kƒç)" field="seoFee" type="number" />
                                    </div>
                                )}

                                {activeTab === 1 && (
                                    <div>
                                        <p className="text-sm text-gray-500 mb-4">üí° GA4 ‚Üí Reports ‚Üí Acquisition ‚Üí Traffic acquisition ‚Üí Filter: Organic Search</p>
                                        <div className="grid grid-cols-2 gap-4">
                                            <InputField label="Revenue (Kƒç)" field="revenue" type="number" />
                                            <InputField label="Revenue YoY" field="revenuePrev" type="number" />
                                            <InputField label="Konverze" field="conversions" type="number" />
                                            <InputField label="Konverze YoY" field="conversionsPrev" type="number" />
                                            <InputField label="Conv. Rate (%)" field="convRate" type="number" />
                                            <InputField label="Conv. Rate YoY" field="convRatePrev" type="number" />
                                        </div>
                                    </div>
                                )}

                                {activeTab === 2 && (
                                    <div className="grid grid-cols-2 gap-4">
                                        <InputField label="Sessions" field="sessions" type="number" />
                                        <InputField label="Sessions YoY" field="sessionsPrev" type="number" />
                                        <InputField label="Clicks" field="clicks" type="number" />
                                        <InputField label="Clicks YoY" field="clicksPrev" type="number" />
                                        <InputField label="Impressions" field="impressions" type="number" />
                                        <InputField label="Impressions YoY" field="impressionsPrev" type="number" />
                                        <InputField label="Avg. Position" field="avgPosition" type="number" />
                                        <InputField label="Position YoY" field="avgPositionPrev" type="number" />
                                        <InputField label="CTR (%)" field="ctr" type="number" />
                                        <InputField label="CTR YoY" field="ctrPrev" type="number" />
                                    </div>
                                )}

                                {activeTab === 3 && (
                                    <div>
                                        <TextArea 
                                            label="Top Pages (URL | Konverze | Conv.Rate | Revenue)" 
                                            field="topPages" 
                                            placeholder="skimmia-japonica | 12 | 7.3 | 15600&#10;jahodovy-strom | 10 | 8.3 | 12000"
                                            rows={5}
                                        />
                                        <p className="text-xs text-gray-500 mb-4">Intent: Transactional, Commercial, Informational, Brand</p>
                                        <TextArea 
                                            label="Top Keywords (Keyword | Intent | Clicks | Position)" 
                                            field="topKeywords" 
                                            placeholder="skimie japonsk√° | Commercial | 63 | 1.38&#10;adventn√≠ vƒõnce | Commercial | 66 | 7.09"
                                            rows={5}
                                        />
                                    </div>
                                )}

                                {activeTab === 4 && (
                                    <div>
                                        <TextArea label="Executive Summary" field="summary" rows={3} />
                                        <div className="grid grid-cols-2 gap-4">
                                            <TextArea label="Realizovan√© aktivity" field="realized" placeholder="SEO audit&#10;Keyword research" rows={4} />
                                            <TextArea label="Pl√°novan√© aktivity" field="planned" placeholder="Linkbuilding&#10;Content calendar" rows={4} />
                                        </div>
                                        <TextArea 
                                            label="Priority (Akce | Impact | Effort | Priority)" 
                                            field="priorities" 
                                            placeholder="Optimalizace str√°nek | +15% conv | Medium | HIGH&#10;Linkbuilding | +50% domains | High | MEDIUM"
                                            rows={3}
                                        />
                                    </div>
                                )}
                            </div>

                            {/* Buttons */}
                            <div className="flex gap-4 mt-6">
                                <button
                                    onClick={() => setShowPreview(true)}
                                    className="flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition"
                                >
                                    üöÄ Zobrazit Report
                                </button>
                            </div>
                        </div>
                    ) : (
                        <div>
                            {/* Preview Controls */}
                            <div className="bg-white shadow-sm py-3 px-4 flex gap-4 justify-center no-print">
                                <button
                                    onClick={() => setShowPreview(false)}
                                    className="bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 transition"
                                >
                                    ‚Üê Zpƒõt na editaci
                                </button>
                                <button
                                    onClick={() => window.print()}
                                    className="bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition"
                                >
                                    üñ®Ô∏è Tisk / PDF
                                </button>
                            </div>

                            {/* Report */}
                            <div className="py-6">
                                <ReportPreview />
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
